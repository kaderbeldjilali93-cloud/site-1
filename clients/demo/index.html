<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ø¹Ø§Ù… | Ù…Ø·Ø¹Ù… Ø§Ù„ÙØ®Ø§Ù…Ø©</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…ÙƒØªØ¨Ø© model-viewer -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>

    <style>
        html {
            scroll-behavior: smooth;
        }
        body { 
            font-family: 'Cairo', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
        }
        
        /* Ø¶Ø¨Ø· Ø§Ù„Ø®Ø·ÙˆØ· Ù„Ù„ØºØ§Øª Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ© */
        html[dir="ltr"] body {
            font-family: sans-serif;
        }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Zoom In Animation */
        @keyframes zoomInSmooth {
            0% { opacity: 0; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }
        .animate-zoom-in { animation: zoomInSmooth 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* Slide Up Reveal Class */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .reveal-visible {
            opacity: 1;
            transform: translateY(0);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.15), inset 0 0 20px rgba(212, 175, 55, 0.05);
            border-color: rgba(212, 175, 55, 0.4);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª */
        .nav-btn {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.01) 100%);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            color: #9ca3af;
            transition: all 0.2s ease;
        }

        .nav-active {
            background: linear-gradient(135deg, #D4AF37 0%, #B5952F 100%) !important;
            color: #09090b !important; 
            box-shadow: 
                0 0 10px rgba(212, 175, 55, 0.5), 
                inset 0 0 5px rgba(255, 255, 255, 0.3) !important;
            border-color: rgba(255, 255, 255, 0.5) !important;
            transform: scale(1.05);
            font-weight: 900 !important;
        }

        .item-card { transition: transform 0.2s, box-shadow 0.3s, border-color 0.3s; }
        .item-card:active { transform: scale(0.97); }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        .pop-anim { animation: pop 0.2s ease-in-out; }

        @keyframes slideUpModal {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-up-smooth { animation: slideUpModal 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        
        /* Logo Glow Animation */
        @keyframes logoPulse {
            0%, 100% { filter: drop-shadow(0 0 8px rgba(212,175,55,0.6)); }
            50% { filter: drop-shadow(0 0 15px rgba(212,175,55,0.9)); }
        }
        .logo-glow { animation: logoPulse 3s infinite; }

        /* ØªØ£Ø«ÙŠØ± ØªÙˆÙ‡Ø¬ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† */
        @keyframes titleGlow {
            0%, 100% { text-shadow: 0 0 5px rgba(212, 175, 55, 0.1); color: #ffffff; transform: scale(1); }
            50% { text-shadow: 0 0 15px rgba(212, 175, 55, 0.6); color: #D4AF37; transform: scale(1.02); }
        }
        
        .glow-text-anim {
            animation: titleGlow 3s infinite ease-in-out;
        }

        /* ØªÙˆÙ‡Ø¬ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        @keyframes welcomeGlow {
            0%, 100% { text-shadow: 0 0 10px rgba(212, 175, 55, 0.2); }
            50% { text-shadow: 0 0 20px rgba(212, 175, 55, 0.5); }
        }
        .welcome-title-anim {
            animation: welcomeGlow 4s infinite ease-in-out;
        }

        /* 3D Glassy Effect for cards */
        .glass-3d {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.01) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        /* Loader CSS */
        #loader-container {
            position: fixed;
            inset: 0;
            background-color: #09090b;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out;
        }
        
        .loader-spinner {
            width: 48px;
            height: 48px;
            border: 5px solid #3f3f46;
            border-bottom-color: #D4AF37;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 500: '#D4AF37', 600: '#B5952F', 100: '#3D3418' }, 
                        dark: { 950: '#09090b', 900: '#18181b', 800: '#27272a', 700: '#3f3f46' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark-950 text-gray-100 pb-28 select-none">

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Loader) -->
    <div id="loader-container">
        <div class="loader-spinner mb-4"></div>
        <p class="text-brand-500 font-bold text-sm animate-pulse" data-i18n="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©...</p>
    </div>

    <!-- 1. Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø«Ø§Ø¨Øª (Header) Ù…Ø¹ ØªÙˆØ²ÙŠØ¹ Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ± -->
    <div class="fixed top-0 w-full bg-dark-950/90 backdrop-blur-xl border-b border-dark-800 z-50 h-[60px] flex items-center px-4 shadow-lg">
        <div class="flex justify-between items-center w-full relative">
            
            <!-- Ø²Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© (Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠÙ…ÙŠÙ† ÙÙŠ RTL / Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø± ÙÙŠ LTR) -->
            <div class="relative z-10 order-first">
                <button onclick="toggleLangMenu()" id="lang-btn" class="flex items-center gap-2 bg-dark-900/50 border border-white/10 text-white px-2.5 py-1.5 rounded-lg active:scale-95 transition-all text-sm font-bold">
                    <span id="current-lang-flag">ğŸ‡©ğŸ‡¿</span>
                    <span id="current-lang-code" class="uppercase">AR</span>
                </button>
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© -->
                <div id="lang-menu" class="hidden absolute top-12 left-0 bg-dark-900 border border-white/10 rounded-2xl shadow-2xl p-2 min-w-[140px] animate-zoom-in glass-3d">
                    <button onclick="setLanguage('ar')" class="w-full flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 rounded-xl transition-colors text-sm font-bold">
                        <span>ğŸ‡©ğŸ‡¿</span> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                    </button>
                    <button onclick="setLanguage('fr')" class="w-full flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 rounded-xl transition-colors text-sm font-bold">
                        <span>ğŸ‡«ğŸ‡·</span> FranÃ§ais
                    </button>
                    <button onclick="setLanguage('en')" class="w-full flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 rounded-xl transition-colors text-sm font-bold">
                        <span>ğŸ‡ºğŸ‡¸</span> English
                    </button>
                </div>
            </div>

            <!-- Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù… (ÙÙŠ Ø§Ù„ÙˆØ³Ø· ØªÙ…Ø§Ù…Ø§Ù‹) -->
            <div class="absolute left-1/2 -translate-x-1/2 flex items-center pointer-events-none">
                <span class="text-xl font-black tracking-tighter text-white font-sans drop-shadow-lg whitespace-nowrap">
                    <span data-i18n="restaurantNamePrefix">Ù…Ø·Ø¹Ù…</span> <span class="text-brand-500" data-i18n="restaurantNameSuffix">Ø§Ù„ÙØ®Ø§Ù…Ø©</span>
                </span>
            </div>

            <!-- Ø²Ø± Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ù†Ø§Ø¯Ù„ (Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø± ÙÙŠ RTL / Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠÙ…ÙŠÙ† ÙÙŠ LTR) -->
            <div class="order-last z-10">
                <button onclick="callWaiter()" id="waiter-btn" class="flex items-center justify-center gap-2 px-3 py-1.5 bg-dark-900/90 backdrop-blur-md border border-brand-500 text-brand-500 rounded-full shadow-[0_0_15px_rgba(212,175,55,0.4)] active:scale-95 transition-all duration-300 group logo-glow">
                    <span class="font-bold text-[10px]" data-i18n="callWaiter">Ø¥Ø³ØªØ¯Ø¹ÙŠ Ø§Ù„Ù†Ø§Ø¯Ù„</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 group-hover:animate-swing" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C10.3431 2 9 3.34315 9 5V6.05202C6.73318 6.92484 5.2323 9.27891 5.62024 11.9939L6.19169 15.9939C6.26252 16.4897 6.03759 16.9855 5.61746 17.2656L4.2886 18.1515C3.76672 18.4994 3.86433 19.324 4.45331 19.5298C6.91896 20.3916 9.53917 20.7302 12 20.7302C14.4608 20.7302 17.081 20.3916 19.5467 19.5298C20.1357 19.324 20.2333 18.4994 19.7114 18.1515L18.3825 17.2656C17.9624 16.9855 17.7375 16.4897 17.8083 15.9939L18.3798 11.9939C18.7677 9.27891 17.2668 6.92484 15 6.05202V5C15 3.34315 13.6569 2 12 2ZM14 22C14 23.1046 13.1046 24 12 24C10.8954 24 10 23.1046 10 22H14Z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
    <div class="pt-[80px]">

        <!-- Ø¹Ù†ÙˆØ§Ù† ØªØ±Ø­ÙŠØ¨ÙŠ -->
        <div class="text-center px-4 mb-6 mt-2 animate-zoom-in">
            <h1 class="text-3xl sm:text-4xl font-black text-white leading-tight welcome-title-anim whitespace-nowrap" data-i18n="welcomeMsg">
                Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙŠÙƒ ÙÙŠ Ù…Ø·Ø¹Ù…Ùƒ<br>
            </h1>
        </div>

        <!-- 2. Ø´Ø±ÙŠØ· Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª (Sticky) - Ø±ÙˆØ§Ø¨Ø· Anchor -->
        <div class="sticky top-[60px] z-40 bg-dark-950/95 backdrop-blur-md border-b border-dark-800/50 py-3 mb-6 shadow-md transition-all">
            <div class="px-2 overflow-x-auto hide-scrollbar flex justify-center">
                <div class="flex gap-2 min-w-max px-2">
                    <button onclick="scrollToSection('pizza')" id="btn-pizza" class="nav-btn px-4 py-2 rounded-lg text-xs font-bold shadow-sm whitespace-nowrap text-center block">Pizza</button>
                    <button onclick="scrollToSection('burger')" id="btn-burger" class="nav-btn px-4 py-2 rounded-lg text-xs font-bold shadow-sm whitespace-nowrap text-center block">Burger</button>
                    <button onclick="scrollToSection('drinks')" id="btn-drinks" class="nav-btn px-4 py-2 rounded-lg text-xs font-bold shadow-sm whitespace-nowrap text-center block">Boissons</button>
                    <button onclick="scrollToSection('sides')" id="btn-sides" class="nav-btn px-4 py-2 rounded-lg text-xs font-bold shadow-sm whitespace-nowrap text-center block">SupplÃ©ments</button>
                </div>
            </div>
        </div>

        <!-- 3. Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ø¹Ø±Ø¶ ÙÙŠ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© - Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ) -->
        <div id="dynamic-menu-container" class="px-3 space-y-12 pb-8 min-h-[500px]"></div>

    </div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø¹Ø§Ø¦Ù… -->
    <div id="cart-bar" class="fixed bottom-6 left-4 right-4 bg-gradient-to-r from-brand-500 to-brand-600 text-dark-950 p-3 rounded-2xl shadow-[0_0_30px_rgba(212,175,55,0.3)] transform translate-y-[150%] transition-transform duration-500 cubic-bezier(0.175, 0.885, 0.32, 1.275) z-50 flex justify-between items-center cursor-pointer active:scale-95 border border-white/20 glass-3d" onclick="openCartModal()">
        <div class="flex items-center gap-3">
            <div class="bg-dark-950 text-brand-500 w-10 h-10 rounded-full flex items-center justify-center font-black text-lg shadow-inner border border-brand-600" id="total-count">0</div>
            <div class="flex flex-col leading-none">
                <span class="text-[10px] text-dark-900 font-bold uppercase tracking-wider" data-i18n="total">Total</span>
                <span class="font-black text-xl" id="total-price">0 Ø¯.Ø¬</span>
            </div>
        </div>
        <div class="flex items-center gap-2 text-dark-950 font-bold bg-white/20 px-4 py-2 rounded-xl hover:bg-white/30 transition backdrop-blur-md border border-white/10 text-sm">
            <span data-i18n="checkCart">ØªØ£ÙƒØ¯ Ù…Ù† Ø·Ù„Ø¨Ùƒ</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 rtl:rotate-180" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù„Ù„Ø³Ù„Ø© -->
    <div id="cart-modal" class="fixed inset-0 bg-dark-950/90 z-[60] hidden backdrop-blur-md flex items-end sm:items-center justify-center transition-opacity duration-300">
        <div class="bg-dark-900 border border-white/10 w-full max-w-md rounded-t-3xl sm:rounded-3xl p-6 relative animate-slide-up-smooth shadow-2xl h-[85vh] sm:h-auto flex flex-col glass-3d">
            
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <span class="text-brand-500">ğŸ›’</span> <span data-i18n="cartTitle">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</span>
                </h2>
                <button onclick="closeCartModal()" class="w-9 h-9 bg-white/5 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition">âœ•</button>
            </div>
            
            <div id="cart-items-list" class="flex-1 overflow-y-auto mb-2 space-y-3 hide-scrollbar pr-1"></div>

            <!-- Ø§Ù„ÙÙˆØªØ± -->
            <div class="mt-auto space-y-4 pt-4 border-t border-white/10">
                <div class="flex justify-between items-center bg-white/5 p-4 rounded-xl border border-white/5 shadow-inner">
                    <span class="text-gray-400 font-bold" data-i18n="total">Total</span>
                    <span class="text-3xl font-black text-brand-500" id="final-price">0 Ø¯.Ø¬</span>
                </div>

                <div id="upsell-section" class="flex flex-col gap-3 hidden"></div>

                <button onclick="submitOrder()" class="w-full bg-gradient-to-r from-[#25D366] to-[#128C7E] hover:from-[#20bd5a] hover:to-[#0e7a6d] text-white font-bold py-4 rounded-xl shadow-[0_0_20px_rgba(37,211,102,0.3)] flex justify-center items-center gap-3 transition-transform active:scale-95 border-t border-white/20">
                    <span data-i18n="confirmOrder">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Error Modal) -->
    <div id="error-modal" class="fixed inset-0 bg-black/80 z-[110] hidden flex items-center justify-center backdrop-blur-sm p-4 animate-zoom-in">
        <div class="bg-dark-900 border border-red-500/30 rounded-2xl p-6 shadow-2xl w-full max-w-sm text-center relative overflow-hidden glass-3d">
            <div class="absolute inset-0 bg-red-500/5 pointer-events-none"></div>
            
            <div class="w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20 shadow-[0_0_20px_rgba(239,68,68,0.2)]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
            </div>
            
            <h3 class="text-xl font-bold text-white mb-2" data-i18n="alertTitle">ØªÙ†Ø¨ÙŠÙ‡</h3>
            <p id="error-message" class="text-gray-400 text-sm mb-6 leading-relaxed">Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.</p>
            
            <button onclick="closeErrorModal()" class="w-full bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 text-red-500 font-bold py-3 rounded-xl transition-all active:scale-95" data-i18n="ok">
                Ø­Ø³Ù†Ø§Ù‹
            </button>
        </div>
    </div>

    <script>
        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø© (Localization System) ---
        const translations = {
            ar: {
                welcomeMsg: "Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙŠÙƒ ÙÙŠ Ù…Ø·Ø¹Ù…Ùƒ",
                restaurantNamePrefix: "Ù…Ø·Ø¹Ù…",
                restaurantNameSuffix: "Ø§Ù„ÙØ®Ø§Ù…Ø©",
                callWaiter: "Ø¥Ø³ØªØ¯Ø¹ÙŠ Ø§Ù„Ù†Ø§Ø¯Ù„",
                viewOnTable: "Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø·Ø§ÙˆÙ„ØªÙƒ",
                add: "Ø£Ø¶Ù",
                cartTitle: "Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª",
                total: "Total",
                checkCart: "ØªØ£ÙƒØ¯ Ù…Ù† Ø·Ù„Ø¨Ùƒ",
                confirmOrder: "ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨",
                alertTitle: "ØªÙ†Ø¨ÙŠÙ‡",
                ok: "Ø­Ø³Ù†Ø§Ù‹",
                currency: "Ø¯.Ø¬",
                loading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©...",
                upsellTitle: "âœ¨ Ù…Ø§ Ø±Ø£ÙŠÙƒ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø§Ù†ØªØ¹Ø§Ø´ØŸ",
                orderSent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ!",
                orderWait: "Ø§Ù„Ù…Ø·Ø¨Ø® ÙŠÙ‚ÙˆÙ… Ø¨ØªØ­Ø¶ÙŠØ± ÙˆØ¬Ø¨ØªÙƒ Ø§Ù„Ø¢Ù†.",
                backHome: "Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                contactKitchen: "Ø¬Ø§Ø±Ù Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø·Ø¨Ø®...",
                connError: "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø·Ø¨Ø®!",
                flag: "ğŸ‡©ğŸ‡¿", code: "AR"
            },
            fr: {
                welcomeMsg: "Bienvenue dans votre restaurant",
                restaurantNamePrefix: "Restaurant",
                restaurantNameSuffix: "Luxe",
                callWaiter: "Appeler Serveur",
                viewOnTable: "Voir sur votre table",
                add: "Ajouter",
                cartTitle: "Votre Panier",
                total: "Total",
                checkCart: "VÃ©rifier commande",
                confirmOrder: "Confirmer la commande",
                alertTitle: "Alerte",
                ok: "OK",
                currency: "DA",
                loading: "Chargement du menu...",
                upsellTitle: "âœ¨ Envie d'une touche de fraÃ®cheur ?",
                orderSent: "Commande envoyÃ©e !",
                orderWait: "La cuisine prÃ©pare votre repas.",
                backHome: "Retour Ã  l'accueil",
                contactKitchen: "Contact cuisine...",
                connError: "Erreur de connexion cuisine !",
                flag: "ğŸ‡«ğŸ‡·", code: "FR"
            },
            en: {
                welcomeMsg: "Welcome to your restaurant",
                restaurantNamePrefix: "Restaurant",
                restaurantNameSuffix: "Luxury",
                callWaiter: "Call Waiter",
                viewOnTable: "View on your table",
                add: "Add",
                cartTitle: "Your Cart",
                total: "Total",
                checkCart: "Check Order",
                confirmOrder: "Confirm & Send Order",
                alertTitle: "Alert",
                ok: "OK",
                currency: "DA",
                loading: "Preparing menu...",
                upsellTitle: "âœ¨ How about something refreshing?",
                orderSent: "Order Sent!",
                orderWait: "The kitchen is preparing your meal.",
                backHome: "Back to Home",
                contactKitchen: "Contacting kitchen...",
                connError: "Kitchen connection error!",
                flag: "ğŸ‡ºğŸ‡¸", code: "EN"
            }
        };

        let currentLang = localStorage.getItem('user_lang') || 'ar';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('user_lang', lang);
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            
            // ØªØ­Ø¯ÙŠØ« Ù†ØµÙˆØµ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø«Ø§Ø¨ØªØ©
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.textContent = translations[lang][key];
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù„Ù… ÙˆØ±Ù…Ø² Ø§Ù„Ù„ØºØ© ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø±
            document.getElementById('current-lang-flag').textContent = translations[lang].flag;
            document.getElementById('current-lang-code').textContent = translations[lang].code;

            // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„ØºØ§Øª
            document.getElementById('lang-menu').classList.add('hidden');

            // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ§Ù„Ø³Ù„Ø© Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
            renderAllSections();
            updateCartBar();
        }

        function toggleLangMenu() {
            document.getElementById('lang-menu').classList.toggle('hidden');
        }

        // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª API ---
        const MENU_API_URL = "https://n8n.vidsai.site/webhook/get-menu";

        let products = [];
        let cart = {};

        const fallbackProducts = [
             { id: 1, name: {ar: "ØªØ´ÙŠØ² Ø¨Ø±ØºØ±", fr: "Cheeseburger", en: "Cheeseburger"}, price: 450, category: "burger", img: "assets/burger/1.jpg", desc: {ar: "Ø¨Ù‚Ø± ØµØ§ÙÙŠØŒ Ø´ÙŠØ¯Ø±", fr: "BÅ“uf pur, cheddar", en: "Pure beef, cheddar"} },
        ];

        async function fetchMenuItems() {
            try {
                const response = await fetch(MENU_API_URL, { method: 'GET' });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();

                let itemsArray = Array.isArray(data) ? data : (data && data.results ? data.results : []);
                
                products = itemsArray
                    .filter(item => {
                         const availability = item.Availability && item.Availability.value ? item.Availability.value : item.Availability;
                         return availability === 'Ù…ØªÙˆÙØ±' || availability === 'Available' || availability === true;
                    })
                    .map(item => {
                        let rawCat = (item.Category && item.Category.value) || item.Category || 'other';
                        rawCat = rawCat.toString().toLowerCase().trim();

                        let category = rawCat;
                        if (rawCat === 'boissons' || rawCat === 'drinks') category = 'drinks';
                        if (rawCat.includes('suppl') || rawCat === 'sides') category = 'sides';

                        let subCat = '';
                        if (category === 'drinks') {
                            const nameLower = (item.Name || '').toLowerCase();
                            subCat = (nameLower.includes('jus') || nameLower.includes('ramy')) ? 'juice' : 'soda';
                        }

                        let imgUrl = 'https://placehold.co/400x300?text=No+Image';
                        const imgField = item.image || item.Image;
                        if (Array.isArray(imgField) && imgField.length > 0) imgUrl = imgField[0].url;
                        else if (typeof imgField === 'string') imgUrl = imgField;

                        let modelField = item["Model 3D"] || item["Model3D"] || item["model_3d"];
                        let modelUrl = (Array.isArray(modelField) && modelField.length > 0) ? modelField[0].url : (typeof modelField === 'string' ? modelField : null);

                        return {
                            id: item.id,
                            name: {
                                ar: item.Name || item.name_ar || "Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",
                                fr: item.Name_FR || item.name_fr || item.Name,
                                en: item.Name_EN || item.name_en || item.Name
                            },
                            price: parseFloat(item.Price) || 0,
                            category: category,
                            sub_category: subCat,
                            img: imgUrl,
                            model3d: modelUrl, 
                            desc: {
                                ar: item.Description || item.desc_ar || "",
                                fr: item.Description_FR || item.desc_fr || item.Description || "",
                                en: item.Description_EN || item.desc_en || item.Description || ""
                            }
                        };
                    });
            } catch (error) {
                console.error("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
                products = fallbackProducts;
            }
        }

        function createProductCard(p) {
            const qty = cart[p.id] ? cart[p.id].qty : 0;
            const localizedName = p.name[currentLang];
            const localizedDesc = p.desc[currentLang];
            
            let mediaContent = p.model3d 
                ? `<div class="absolute bottom-2 left-1/2 -translate-x-1/2 w-3/4 h-6 bg-[radial-gradient(ellipse_at_center,_rgba(0,0,0,0.8)_0%,_rgba(0,0,0,0)_70%)] blur-md pointer-events-none z-0"></div>
                   <model-viewer src="${p.model3d}" ar ar-modes="webxr scene-viewer quick-look" environment-image="neutral" auto-rotate camera-controls class="w-full h-full object-cover relative z-10" alt="${localizedName}"></model-viewer>`
                : `<img src="${p.img}" onerror="this.src='https://placehold.co/400x300?text=No+Image'" class="w-full h-full object-cover brightness-90 group-hover:brightness-110 group-hover:scale-105 transition duration-500 relative z-10" alt="${localizedName}">`;

            const arButtonHTML = p.model3d 
                ? `<button onclick="const mv = this.closest('.glass-3d').querySelector('model-viewer'); if(mv) mv.activateAR();" class="w-[85%] mx-auto bg-dark-800 border border-brand-500/30 text-brand-500 py-1.5 rounded-full text-xs font-bold mb-3 flex justify-center items-center gap-2 active:scale-95 transition-transform">
                        <span class="text-sm">ğŸ‘ï¸</span> ${translations[currentLang].viewOnTable}
                   </button>` 
                : '';

            return `
            <div class="glass-3d rounded-2xl overflow-hidden reveal-on-scroll h-full flex flex-col relative group">
                <div class="pt-4 px-3 pb-2 text-center relative z-20">
                    <h3 class="font-bold text-gray-100 text-sm mb-1 leading-tight tracking-wide">${localizedName}</h3>
                    <p class="text-[10px] text-gray-400 line-clamp-2 leading-relaxed font-light">${localizedDesc}</p>
                </div>
                <div class="h-48 w-full relative bg-gray-800 flex items-center justify-center overflow-hidden">
                    ${mediaContent}
                    <div class="absolute inset-0 bg-gradient-to-t from-dark-950/80 to-transparent opacity-60 pointer-events-none z-10"></div>
                </div>
                <div class="p-3 pt-3 flex flex-col justify-center items-center relative z-20 w-full mt-auto">
                    ${arButtonHTML}
                    <div id="controls-${p.id}" class="w-full flex items-center justify-center">
                        ${generateControlsHTML(p, qty)}
                    </div>
                </div>
            </div>`;
        }

        function generateControlsHTML(p, qty) {
            const priceVal = p.price === 0 ? "Gratuit" : `${p.price} <span class="text-[10px] font-normal opacity-70">${translations[currentLang].currency}</span>`;

            if (qty > 0) {
                return `
                <div class="w-[85%] mx-auto flex justify-between items-center bg-white/10 rounded-full p-1 border border-brand-500/50 h-12 animate-zoom-in backdrop-blur-sm">
                    <button onclick="updateCart(${p.id}, -1)" class="w-12 h-full bg-dark-900 rounded-full text-brand-500 font-bold flex items-center justify-center hover:bg-brand-500 hover:text-dark-950 transition text-xl shadow-inner">-</button>
                    <span class="font-black text-lg w-8 text-center text-white">${qty}</span>
                    <button onclick="updateCart(${p.id}, 1)" class="w-12 h-full bg-brand-500 rounded-full text-dark-950 font-black flex items-center justify-center hover:bg-brand-400 active:scale-95 transition-transform text-xl shadow-md">+</button>
                </div>`;
            } else {
                return `
                <button onclick="updateCart(${p.id}, 1)" class="w-[85%] mx-auto bg-brand-500 text-dark-950 py-2.5 px-5 rounded-full font-bold flex justify-between items-center shadow-lg active:scale-95 transition-transform">
                    <span class="text-base leading-none">${priceVal}</span>
                    <span class="text-2xl font-black leading-none mb-1 text-dark-950">+</span>
                </button>`;
            }
        }

        function renderAllSections() {
            const container = document.getElementById('dynamic-menu-container');
            container.innerHTML = '';
            const categoriesConfig = [
                { id: 'pizza', title: 'Pizza' },
                { id: 'burger', title: 'Burger' },
                { id: 'drinks', title: 'Boissons', subSections: [{ id: 'soda', title: 'Sodas' }, { id: 'juice', title: 'Jus' }] },
                { id: 'sides', title: 'SupplÃ©ments' }
            ];
            categoriesConfig.forEach(cat => {
                const catProducts = products.filter(p => p.category === cat.id);
                if (catProducts.length === 0) return;
                const section = document.createElement('section');
                section.id = `section-${cat.id}`;
                section.className = "scroll-mt-44 text-center mb-4";
                section.innerHTML = `<h2 class="text-2xl font-black text-white uppercase tracking-wider glow-text-anim mb-4">${cat.title}</h2>`;
                const grid = document.createElement('div');
                grid.className = "grid grid-cols-2 gap-3";
                if (cat.subSections) {
                    cat.subSections.forEach(sub => {
                        const subProducts = catProducts.filter(p => p.sub_category === sub.id);
                        if (subProducts.length > 0) grid.innerHTML += subProducts.map(createProductCard).join('');
                    });
                } else { grid.innerHTML = catProducts.map(createProductCard).join(''); }
                section.appendChild(grid);
                container.appendChild(section);
            });
            initRevealObserver();
        }

        function initRevealObserver() {
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => { entry.target.classList.add('reveal-visible'); }, index * 50); 
                        revealObserver.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1, rootMargin: '50px' });
            document.querySelectorAll('.reveal-on-scroll').forEach(el => revealObserver.observe(el));
        }

        function scrollToSection(sectionId) {
            const element = document.getElementById('section-' + sectionId);
            if (element) window.scrollTo({ top: element.offsetTop - 140, behavior: "smooth" });
        }

        function updateCart(id, change) {
            if (!cart[id]) cart[id] = { ...products.find(p => p.id === id), qty: 0 };
            cart[id].qty += change;
            if (cart[id].qty <= 0) delete cart[id];
            const controlsDiv = document.getElementById(`controls-${id}`);
            if (controlsDiv) {
                const p = products.find(x => x.id === id);
                controlsDiv.innerHTML = generateControlsHTML(p, cart[id] ? cart[id].qty : 0);
            }
            updateCartBar();
            if(navigator.vibrate) navigator.vibrate(40);
        }

        function updateCartBar() {
            const totalQty = Object.values(cart).reduce((a, b) => a + b.qty, 0);
            const totalPrice = Object.values(cart).reduce((a, b) => a + (b.price * b.qty), 0);
            document.getElementById('total-count').innerText = totalQty;
            const formattedPrice = `${totalPrice} ${translations[currentLang].currency}`;
            document.getElementById('total-price').innerText = formattedPrice;
            document.getElementById('final-price').innerText = formattedPrice;
            const cartBar = document.getElementById('cart-bar');
            if (totalQty > 0) cartBar.classList.remove('translate-y-[150%]');
            else cartBar.classList.add('translate-y-[150%]');
        }

        function openCartModal() {
            const list = document.getElementById('cart-items-list');
            list.innerHTML = '';
            if (Object.keys(cart).length === 0) return;
            Object.values(cart).forEach(item => {
                list.innerHTML += `
                    <div class="flex justify-between items-center text-sm border-b border-white/10 pb-3 last:border-0 animate-slide-up-smooth">
                        <div class="flex items-center gap-3">
                            <span class="bg-white/10 text-brand-500 px-2.5 py-1 rounded text-xs font-bold border border-white/10">x${item.qty}</span>
                            <span class="font-medium text-gray-200">${item.name[currentLang]}</span>
                        </div>
                        <div class="flex items-center gap-3">
                             <span class="font-bold text-brand-500">${item.price === 0 ? 'Free' : (item.price * item.qty) + ' ' + translations[currentLang].currency}</span>
                             <button onclick="removeFromCart(${item.id})" class="text-red-400 text-xs px-2 py-1 bg-red-500/10 rounded hover:bg-red-500/30 transition">âœ•</button>
                        </div>
                    </div>`;
            });
            document.getElementById('cart-modal').classList.remove('hidden');
        }

        function closeCartModal() { document.getElementById('cart-modal').classList.add('hidden'); }
        function removeFromCart(id) {
            delete cart[id];
            const p = products.find(x => x.id === id);
            const controlsDiv = document.getElementById(`controls-${id}`);
            if(controlsDiv && p) controlsDiv.innerHTML = generateControlsHTML(p, 0);
            updateCartBar();
            openCartModal();
            if(Object.keys(cart).length === 0) closeCartModal();
        }

        async function callWaiter() {
            const btn = document.getElementById('waiter-btn');
            const originalContent = btn.innerHTML;
            new Audio('assets/sound_effect/wiater.mp3').play().catch(e => {});
            btn.innerHTML = `<svg class="animate-spin h-5 w-5 text-brand-500" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;
            btn.disabled = true;
            try {
                const WH_URL = "https://n8n.vidsai.site/webhook/146e5a16-fe2c-4d4e-8284-4f6900a40931"; 
                // Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… Ø·Ø§ÙˆÙ„Ø© Ø«Ø§Ø¨Øª "5"
                await fetch(WH_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ table: '5', type: 'help', lang: currentLang }) });
                btn.classList.replace('text-brand-500', 'text-green-500');
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>`;
            } catch (error) { showErrorModal(translations[currentLang].connError); }
            finally { setTimeout(() => { btn.classList.replace('text-green-500', 'text-brand-500'); btn.innerHTML = originalContent; btn.disabled = false; }, 3000); }
        }

        async function submitOrder() {
            if (Object.keys(cart).length === 0) return;
            const btn = document.querySelector('#cart-modal button:last-child');
            const originalText = btn.innerHTML;
            btn.innerHTML = translations[currentLang].contactKitchen;
            btn.disabled = true;
            try {
                const WEBHOOK_URL = "https://n8n.vidsai.site/webhook/c25c8a4a-e633-4ae8-80f0-adece675548b"; 
                // Ø¥Ø±Ø³Ø§Ù„ ÙƒØ§Ø¦Ù† ÙƒØ§Ù…Ù„ ÙŠØªØ¶Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ø·Ø§ÙˆÙ„Ø© ÙˆØ§Ù„Ù„ØºØ© Ù„Ø¶Ù…Ø§Ù† ÙØ±Ø²Ù‡Ø§ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª
                const orderPayload = { 
                    items: Object.values(cart), 
                    table: "5", 
                    lang: currentLang 
                };
                const response = await fetch(WEBHOOK_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(orderPayload) });
                if (response.ok) {
                    new Audio('assets/sound_effect/success.mp3').play().catch(e => {});
                    closeCartModal();
                    showSuccessOrderModal();
                    cart = {}; updateCartBar();
                } else throw new Error();
            } catch (error) { showErrorModal(translations[currentLang].connError); }
            finally { btn.innerHTML = originalText; btn.disabled = false; }
        }

        function showSuccessOrderModal() {
            const modal = document.createElement('div');
            modal.className = "fixed inset-0 bg-dark-950/95 z-[70] flex flex-col items-center justify-center p-4 text-center animate-zoom-in";
            modal.innerHTML = `
                <div class="w-24 h-24 bg-green-500/10 rounded-full flex items-center justify-center mb-6 border border-green-500/20 shadow-[0_0_30px_rgba(34,197,94,0.2)]">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg>
                </div>
                <h2 class="text-3xl font-black text-white mb-2">${translations[currentLang].orderSent}</h2>
                <p class="text-gray-400 mb-8 max-w-xs leading-relaxed">${translations[currentLang].orderWait}</p>
                <button onclick="location.reload()" class="bg-dark-800 text-white px-8 py-4 rounded-xl font-bold border border-dark-700 w-full max-w-xs shadow-lg">${translations[currentLang].backHome}</button>`;
            document.body.appendChild(modal);
        }

        document.addEventListener('DOMContentLoaded', async () => {
            await fetchMenuItems();
            setLanguage(currentLang); 
            document.getElementById('loader-container').style.display = 'none';
        });
    </script>
    
    <style>
    @keyframes swing { 0%, 100% { transform: rotate(0deg); } 20% { transform: rotate(15deg); } 40% { transform: rotate(-10deg); } 60% { transform: rotate(5deg); } 80% { transform: rotate(-5deg); } }
    .group-hover\:animate-swing:hover { animation: swing 1s ease-in-out infinite; }
    .logo-glow { animation: logoPulse 2s infinite; }
    </style>
</body>
</html>